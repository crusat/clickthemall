<!DOCTYPE html>
<html>
<head>
    <title>Click Them All</title>
    <link rel="stylesheet" href="css/style.css" type="text/css">
    <script type="text/javascript" src="js/jquery-1.8.1.min.js"></script>
    <script type="text/javascript" src="js/game.js"></script>
</head>
<body>
    <div id="src"></div>
<script>
    // Привязываем события ко всем элементам
    $('.gamebrick').live('click', function() {
        var $this = $(this);
        if ((!$this.hasClass('white'))&&(!$this.hasClass('heart-white'))) {
            var x = $this.attr('data-x');
            var y = $this.attr('data-y');
            var col = gameField[y][x];
            var arr = deleteFromGF(gameField, x, y, col, 0);
            gameField = arr['gf'];
            score += arr['currcount'];
            document.getElementById('src').innerHTML = render(gameField, colors, 'ball', sizeX, sizeY);
            $('.remove').fadeOut(200);
            setTimeout(function() {
                for(var x = 0; x < gameField.length; x++) {
                    for(var y = 0; y < gameField[0].length; y++) {
                        if (gameField[y][x] < 0) {
                            gameField[y][x] = 0;
                        }
                    }
                }
                gameField = falling(gameField);
                document.getElementById('src').innerHTML = render(gameField, colors, 'ball', sizeX, sizeY);
            }, 250);
            console.log('SCORE: '+score);
        }
    });


    var gameField = [];
    var gamefield_width = 10;
    var gamefield_height = 10;
    var sizeX = 50;//25;
    var sizeY = 45;//25;
    var score = 0;
    var src_width = sizeX * gamefield_width;
    $('#src').css('width', src_width+'px');
    var colors = ['white', 'green', 'red', 'yellow', 'blue'];
    gameField = createArray(gamefield_width, gamefield_height, 1, 4);
    document.getElementById('src').innerHTML = render(gameField, colors, 'ball', sizeX, sizeY);
</script>
</body>
</html>